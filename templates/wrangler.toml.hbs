name = "ethereum-events-worker-{{environment}}"

main = "dist/index.mjs"
compatibility_date = "2022-05-28"
account_id = ""
workers_dev = {{devMode}}

usage_model= "bundled"

# TODO investigate why ethers node version is used
node_compat = true

[build]
command = "node build.js"

[triggers]
crons = ["* * * * *"]

[vars]
ENVIRONMENT = "{{environment}}"
ETHEREUM_NODE = "{{ETHEREUM_NODE}}"
DATA_DOG_API_KEY = "{{DATA_DOG_API_KEY}}"


[durable_objects]
bindings = [{name = "EVENT_LIST", class_name = "EventList"}]


[[migrations]]
tag = "v1"
new_classes = ["EventList"]

[miniflare]
kv_persist = true
cache_persist = true
# durable_objects_persist = true

